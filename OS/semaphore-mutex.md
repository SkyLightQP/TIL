# 세마포어와 뮤텍스

여러개의 프로세스(스레드)가 같은 자원에 접근하면서 Race Condition 문제가 생기게 됩니다. 이 문제를 해결하기 위해 Semaphore와 Mutex를 사용해서 하나의 프로세스만 자원에 접근하도록 막을 수 있습니다.

Race Condition이 발생할 수 있는 구역을 Critical Section(임계 구역)이라고 합니다.

## Semaphore

특정 자원에 *한 개 이상*의 프로세스가 접근할 수 있도록 합니다. 무조건 1개의 프로세스를 막는게 아니라 n개 이상의 프로세스도 자원에 접근하도록 허용할 수 있습니다.

Atomic 단위로 실행되는 변수와 함수를 사용해서 구현합니다. 임의의 카운트 변수 $C$가 있을 때, $C$가 0이면 접근이 불가능하다는 뜻입니다. 0이 아니라면 접근이 가능하고, 접근할 때마다 카운트를 차감시켜 다른 프로세스가 접근하지 못하도록 막습니다. 작업이 끝나면(자원을 반납하면) 카운트를 다시 증가시킵니다.

예를 들어 $C$의 값을 2로 설정한다면, 동시에 2개의 프로세스가 자원을 사용할 수 있습니다.

## Mutex

자원을 하나의 프로세스만 사용할 수 있도록 락을 거는 방법입니다. Mutual Exclusion(상호 배제)의 약자입니다.

Atomic 단위로 실행되는 Lock과 Unlock 함수를 사용해서 임계 구역에 접근 전 락을 걸어줍니다. 다른 프로세스는 락이 걸려있기 때문에 임계 구역에 접근할 수 없습니다. 작업이 끝나면 락을 해제합니다.

Mutex는 0과 1만 $C$ 값으로 갖는 Binary Semaphore라고 볼 수 있습니다. 또한 Mutex는 잠금을 획득한 프로세스(스레드)만 잠금을 해제할 수 있는 소유권 개념이 있지만, Semaphore는 소유권 개념이 없어 다른 프로세스가 Semaphore에 관련된 연산을 할 수 있습니다.
